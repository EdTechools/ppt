import{d as n,g as a,e as u,f as v}from"./shortcuts-BeL4JqRq.js";import"./modules/vue-BOVj5Shv.js";import"./index-pFKLFa-J.js";import"./modules/shiki-sKuWUF9L.js";import"./slidev/DrawingPreview.vue_vue_type_script_setup_true_lang-DFhvOrCk.js";import"./slidev/SlideContainer-C97zvfND.js";import"./modules/unplugin-icons-Ca8F49f6.js";import"./status_store-DRWidOEM.js";import"./slidev/IconButton.vue_vue_type_script_setup_true_lang-BXU6HbqL.js";import"./SlideWrapper-C7Hnvpkd.js";let e;const o=u();function O(t,i){if(e)t();else{e=new EventSource(`${o}/event?uid=${n.value}`),e.addEventListener("error",i),e.addEventListener("open",t);const r=s=>{const{states:d,uid:p}=JSON.parse(s.data);v.value.forEach(c=>c(d,p))};e.addEventListener("patch",r),e.addEventListener("replace",r)}}function J(t){e&&fetch(`${o}/connect?uid=${n.value}`,{body:JSON.stringify({id:a.value,states:t}),method:"POST",headers:{"content-type":"application/json"}})}function N(t,i){e&&fetch(`${o}/patch?uid=${n.value}`,{body:JSON.stringify({id:a.value,states:{[t]:i}}),method:"POST",headers:{"content-type":"application/json"}})}export{O as init,J as open,N as patch};
